---

ubtu18stig_report_dir: /tmp

ubtu18stig_cat1_patch: true
ubtu18stig_cat2_patch: true
ubtu18stig_cat3_patch: true

# We've defined complexity-high to mean that we cannot automatically remediate
# the rule in question.  In the future this might mean that the remediation
# may fail in some cases.
ubtu18stig_complexity_high: false

# Show "changed" for complex items not remediated per complexity-high setting
# to make them stand out.  "changed" items on a second run of the role would
# indicate items requiring manual review.
ubtu18stig_audit_complex: true

# We've defined disruption-high to indicate items that are likely to cause
# disruption in a normal workflow.  These items can be remediated automatically
# but are disabled by default to avoid disruption.
ubtu18stig_disruption_high: true

# Show "changed" for disruptive items not remediated per disruption-high
# setting to make them stand out.
ubtu18stig_audit_disruptive: true

ubtu18stig_skip_for_travis: false

ubtu18stig_workaround_for_disa_benchmark: true
ubtu18stig_workaround_for_ssg_benchmark: true

# tweak role to run in a chroot, such as in kickstart %post script
ubtu18stig_system_is_chroot: "{{ ansible_is_chroot | default(False) }}"

# tweak role to run in a non-privileged container
ubtu18stig_system_is_container: false

system_is_ec2: false

# These variables correspond with the STIG IDs defined in the STIG and allows you to enable/disable specific rules.
# PLEASE NOTE: These work in coordination with the cat1, cat2, cat3 group variables. You must enable an entire group
# in order for the variables below to take effect.
# CAT 1 rules
ubtu_18_010000: true
ubtu_18_010001: true
ubtu_18_010005: true
ubtu_18_010018: true
ubtu_18_010019: true
ubtu_18_010037: true
ubtu_18_010105: true
ubtu_18_010150: true
ubtu_18_010151: true
ubtu_18_010412: true
ubtu_18_010420: true
ubtu_18_010424: true
ubtu_18_010426: true
ubtu_18_010522: true
ubtu_18_010523: true

# CAT 2 Rules
ubtu_18_010002: true
ubtu_18_010003: true
ubtu_18_010016: true
ubtu_18_010017: true
ubtu_18_010021: true
ubtu_18_010022: true
ubtu_18_010023: true
ubtu_18_010033: true
ubtu_18_010035: true
ubtu_18_010036: true
ubtu_18_010038: true
ubtu_18_010104: true
ubtu_18_010109: true
ubtu_18_010110: true
ubtu_18_010112: true
ubtu_18_010113: true
ubtu_18_010114: true
ubtu_18_010116: true
ubtu_18_010120: true
ubtu_18_010121: true
ubtu_18_010122: true
ubtu_18_010123: true
ubtu_18_010124: true
ubtu_18_010125: true
ubtu_18_010126: true
ubtu_18_010127: true
ubtu_18_010128: true
ubtu_18_010129: true
ubtu_18_010130: true
ubtu_18_010133: true
ubtu_18_010134: true
ubtu_18_010135: true
ubtu_18_010136: true
ubtu_18_010137: true
ubtu_18_010138: true
ubtu_18_010139: true
ubtu_18_010140: true
ubtu_18_010141: true
ubtu_18_010142: true
ubtu_18_010143: true
ubtu_18_010144: true

# CAT 3 Rules
ubtu_18_010006: true
ubtu_18_010007: true
ubtu_18_010008: true
ubtu_18_010025: true
ubtu_18_010030: true
ubtu_18_010031: true
ubtu_18_010032: true
ubtu_18_010100: true
ubtu_18_010101: true
ubtu_18_010102: true
ubtu_18_010103: true
ubtu_18_010106: true
ubtu_18_010107: true
ubtu_18_010108: true
ubtu_18_010145: true
ubtu_18_010314: true
ubtu_18_010400: true
ubtu_18_010437: true
ubtu_18_010447: true
ubtu_18_010502: true
ubtu_18_010503: true

# ubtu18cis_desktop_required is the toggle to turn on desktop related controls
# value of true will run tasks that are intended for the desktop, false will skip desktop related controls
ubtu18cis_desktop_required: false

# Install and enable ssh on networked systems
ubtu18stig_ssh_required: true

# Service configuration variables, set to true to keep service
ubtu18stig_nis_required: false
ubtu18stig_rsh_required: false
ubtu18stig_telnet_required: false

# The variables below are related to specific tasks
# CAT 1

# UBTU-18-010000
# Passowrd protect bootloader
# DO NOT USE PLAIN TEXT PASSWORDS!!!!
# The has is intended to be used with a PW management tool like Ansible Vault
ubtu18stig_bootloader_password_hash: 'grub.pbkdf2.sha512.changethispassword'
ubtu18stig_boot_superuser: root

# UBTU-18-010037
# ubtu18_allowed_sudoers is the list of users who should be in the sudoers group
# With this enabled all other users will be removed from the sudoers group
ubtu18_allowed_sudoers:
    - test1
    - rad
# ubtu18_auto_remove_sudoers is the toggle to let this role remove users from the sudoers
# group if they do not match the list above.
# Set this value to false and the task will just message out the list of users in the sudo group
ubtu18_auto_remove_sudoers: true

# Cat 2
# UBTU-18-010033
# ubtu18stig_pamd_faillock are the settings related to the pam_faillock.so module and controls
# The settings type, control, module_path, and state need to correspond to an existing rule in /etc/pam.d/common-auth, which is used
# as a referrence in adding the auth required pam_faillock.so authfail and authsucc settings if pam_faillock.so does not already exist.
# The state value determines before or after the stated type/control/module_path.
# deny is the number of failed login attempts before denying access. This value needs to be 3 or lower
# fail_interval is how long the account is lockedout in seconds. This value needs to be 900 or less
ubtu18stig_pamd_faillock:
    type: auth
    control: "[success=1 default=ignore]"
    module_path: pam_unix.so
    state: after
    deny: 3
    fail_interval: 900

# UBTU-18-010035
# ubtu18cis_warning_banner is the banner to be displayed when logging into a system
ubtu18cis_warning_banner: |
    'You are accessing a U.S. Government (USG) Information System (IS) that is
    provided for USG-authorized use only.

    By using this IS (which includes any device attached to this IS), you consent
    to the following conditions:

    -The USG routinely intercepts and monitors communications on this IS for
    purposes including, but not limited to, penetration testing, COMSEC monitoring,
    network operations and defense, personnel misconduct (PM), law enforcement
    (LE), and counterintelligence (CI) investigations.

    -At any time, the USG may inspect and seize data stored on this IS.

    -Communications using, or data stored on, this IS are not private, are subject
    to routine monitoring, interception, and search, and may be disclosed or used
    for any USG-authorized purpose.

    -This IS includes security measures (e.g., authentication and access controls)
    to protect USG interests--not for your personal benefit or privacy.

    -Notwithstanding the above, using this IS does not constitute consent to PM, LE
    or CI investigative searching or monitoring of the content of privileged
    communications, or work product, related to personal representation or services
    by attorneys, psychotherapists, or clergy, and their assistants. Such
    communications and work product are private and confidential. See User
    Agreement for details.'

# UBTU-18-010104
# UBTU-18-010110
# encrypt_method is the encryption method and to conform to STIG standards needs to be SHA512
ubtu18stig_login_defaults:
    encrypt_method: SHA512
    # pass_min_days: 1
    # pass_max_days: 60
    # fail_delay_secs: 4
    # umask: '077'
    # create_home: 'yes'

# UBTU-18-010109
# Password complexity settings
ubtu18stig_password_complexity:
    # ucredit: -1
    # lcredit: -1
    # dcredit: -1
    # ocredit: -1
    # difok: 8
    # minclass: 4
    # maxrepeat: 3
    # maxclassrepeat: 4
    minlen: 15
    dictcheck: 1

# UBTU-18-010110
# ubtu18stig_pamd_encryption are the pam_unix settings related to setting the encryption schema for logins.
# The settings type, control, module_path, and state need to correspond to an existing rule in /etc/pam.d/common-password, which is used
# as a referrence in adding the pam_unix.so entry and encryption parameter.
# new_control is the control settings for the pam_unix.so settings, by default we have the default value entered here. It can be
# modified 
ubtu18stig_pamd_encryption:
    new_control: "[success=1 default=ignore]"
    type: password
    control: requisite
    module_path: pam_deny.so
    state: before
    encryption: sha512

# UBTU-18-010116
# ubtu18cis_pam_pwquality_retry is the number of times a password entry fails before warning with an error
# To conform with STIG standards this value needs to be higher than 0 but no more than 3
ubtu18stig_pam_pwquality_retry: 3
# ubtu18stig_pamd_retry are the settings related to adding the pam_pwquality.so retry value.
# The settings type, control, module_path, and state need to correspond to an existing rule in /etc/pam.d/common-password, which is used
# as a referrence in adding the pam_pwquality.so entry and retry parameter.
ubtu18stig_pamd_retry:
  type: password
  control: requisite
  module_path: pam_deny.so
  state: after

# UBTU-18-010124
# ubtu18cis_var_log_perms is the permissions on the /var/log directory
# To conform to STIG starndards this needs to be 0750 or more restrictive
ubtu18cis_var_log_perms: 750

# UBTU-18-010127
# ubtu18cis_var_log_syslog_perms is the permissions on the /var/log/syslog file
# To conform to STIG standards this needs to be 0640 or more restrictive
ubtu18cis_var_log_syslog_perms: 640

# ubtu18cis_tool_perms is the permissions set to the /sbin/auditctl, /sbin/aureport,
# /sbin/ausearch, /sbin/autrace, /sbin/auditd, /sbin/audispd, /sbin/augenrules tools
# To conform to STIG standards this needs to be 0755 or more restrictive
ubtu18cis_tool_perms: 755

# UBTU-18-010133
# ubtu18stig_lib_file_perms are the perms to put on all library files if they are found be less restricive than 755
# To conform to STIG standards this value needs to be 755 or more restricive
ubtu18stig_lib_file_perms: 755

# UBTU-18-010134
# ubtu18stig_lib_dir_perms are the perms to put on the library directories if they are found to be less restricive than 755
# To conform to STIG standards this value needs to be 755 or more restricive
ubtu18stig_lib_dir_perms: 755

# UBTU-18-010129
# ubtu18stig_sys_commands_perms are the permissions to put on the OS system command files if they are found to be less restricive than 755
# To conform to STIG standards this value needs to be 755 or more restricive
ubtu18stig_sys_commands_perms: 755

# ubtu18stig_sys_comm_dir_perms are the permissions to put on the OS system commands directories if they are found to be less restricive than 755
# To conform to STIG standards this value needs to be 755 or more restricive
ubtu18stig_sys_comm_dir_perms: 755

# CAT 3

# UBTU-18-010006
# ubtu18cis_auditd_space_left_action is the setting on which who is notified when audit record storage volume
# reaches 75% of the repository maximum
# To conform to STIG standards this value needs to be exec or email
ubtu18stig_auditd_space_left_action: "email"
# ubtu18stig_auditd_action_mail_acct is the email account used when ubtu18stig_auditd_space_left_action is set to email
ubtu18stig_auditd_action_mail_acct: root
# ubtu18cis_auditd_space_left is the setting for how much space (as a percentage) is left before alerting the space_left_action accounts
# To conform to STIG standards this value needs to be 25% or less
# The Admin space left is not part of the STIG, but can't be more than the space_left value
ubtu18stig_auditd_space_left: 25
ubtu18stig_auditd_admin_space_left: 20

# UBTU-18-010007
# UBTU-18-010025
# ubtu18stig_audispd_remote_servers is the address of the remote server recieving the auditd logs
ubtu18stig_audispd_remote_servers: 10.10.10.10

# UBTU-18-010031
# ubtu18stig_pamd_faildelay are the pam.d placement settings and value for the delay
# The settings type, control, module_path, and state need to correspond to an existing rule in /etc/pam.d/common-auth, which is used
# as a referrence in adding the auth required pam_faildelay.so delay= value if pam_faildelay does not already exist.
# The state value determines before or after the stated type/control/module_path.
# The delay setting is is in microseconds and needs to be a minimum 4 seconds (4000000) to conform to STIG standards
ubtu18stig_pamd_faildelay:
    type: auth
    control: required
    module_path: pam_permit.so
    state: after
    delay: 4000000

# UBTU-18-010032
# ubtu18stig_pamd_showfailed are the pam.d placement settings and for the showfail setting.
# The settings type, control, module_path, and state need to correspond to an existing rule in /etc/pam.d/login, which is used
# as a referrence in adding the showfail parameter.
ubtu18stig_pamd_showfailed:
    type: session
    control: required
    module_path: pam_limits.so
    state: before

# UBTU-18-010100
# ubtu18cis_pwquality_ucredit is the value set to the ucredit parameter in the /etc/security/pwquality.conf file
# To conform to STIG standards the value can be no larger than -1, so the next incremental value should be -2
ubtu18stig_pwquality_ucredit: "-1"

# UBTU-18-010101
# ubtu18stig_pwquality_lcredit is the value set to the lcredit parameter in the /etc/security/pwquality.conf file
# To conform to STIG standards the value can be no larger than -1, so the next incremental value should be -2
ubtu18stig_pwquality_lcredit: "-1"

# UBTU-18-010102
# ubtu18stig_pwquality_dcredit is the value set to the dcredit parameter in the /etc/security/pwquality.conf file
# To conform to STIG standards the value can be no larger than -1, so the next incremental value should be -2
ubtu18stig_pwquality_dcredit: "-1"

# UBTU-18-010103
# ubtu18stig_pwquality_difok is the value set to the difork parameter in the /etc/security/pwquality.conf file
# To conform to STIG standards the value can be no less than 8.
ubtu18stig_pwquality_difok: 8

# UBTU-18-010106
# ubtu18stig_pass_min_days is the value for PASS_MIN_DAYS, which is the minimum number of days for a PW's lifetime
# To conform to STIG standards this value can be no smaller than 1
ubtu18stig_pass_min_days: 1

# UBTU-18-010107
# ubtu18stig_pass_max_days is the value for PASS_MAX_DAYS, which is the maximum nubmer of days for a PW's lifetime
# To conform to STIG standards this value can be no smaller than 60
ubtu18stig_pass_max_days: 60

# UBTU-18-010108
# ubtu18stig_pamd_remember are the pam.d placement settings and value for password remember setting
# The settings, type, control, module_path, and state need to correspond to an existing rule in /etc/pam.d/common-password, which is used
# as a referrence in adding the password [success default] pam_unix.so remember values if pam_unix.so with success/default do not already exist.
# new_control is the value for the success and deafult with pam_unix.so
# remember is the number of generations to remember, this value should be no less than 5.
ubtu18stig_pamd_remember:
    new_control: "[success=1 default=ignore]"
    type: password
    control: requisite
    module_path: pam_pwquality.so
    state: after
    remember: 5

# UBTU-18-010145
# ubtu18stig_pwquality_ocredit is the value for number of special characters
# To conform to STIG standards this value can be no larger than -1, so the next incremental value should be -2
ubtu18stig_pwquality_ocredit: "-1"

# UBTU-18-010400
# ubtu18stig_maxlogins is max number of concurrent sessions
# To conform to STIG standards this value can be no larger than 10.
ubtu18stig_maxlogins: 10

# ubtu18stig_chrony will be all of the settings needed for chrony
# ubtu18stig_010502
# makestep is the value for the chrony makestep threshhold limit
ubtu18stig_chrony:
    makestep: "1 -1"

# UBTU-18-010503
# ubtu18cis_timezone is the timezone to configure the host in
ubtu18cis_timezone: "EST"
